**Web-based exploits** are malicious code or behavior that's used to take advantage of coding flaws in a web application. Cybercriminals target web-based exploits to obtain sensitive personal information. Attacks occur because web applications interact with multiple users across multiple networks. Malicious hackers commonly exploit this high level of interaction using injection attacks.

An **injection attack** is malicious code inserted into a vulnerable application. The infected application often appears to work normally. That's because the *injected code runs in the background, unknown to the user*. Applications are vulnerable to injection attacks because they are programmed to receive data inputs. This could be something the user types, clicks, or something one program is sharing with another. When coded correctly, applications should be able to interpret and handle user inputs.

***For example***, let's say an application is expecting the user to enter a phone number. This application should validate the input from the user to make sure the data is all numbers and not more than ten digits. If the input from the user doesn't meet these requirements, the application should know how to handle it. Web apps interact with multiple users across many platforms. They also have a lot of interactive objects like images and buttons. This makes it challenging for developers to think of all the ways they should sanitize their input.


## Types of injection attacks

### Cross site scripting 
A common and dangerous type of injection attack that's a threat to web apps is cross-site scripting. **Cross site scripting, or XSS**, is an injection attack that inserts code into a vulnerable website or web application. These attacks are often delivered by exploiting the two languages used by most websites, HTML and JavaScript. Both can give cybercriminals access to everything that loads on the infected web page. *This can include session cookies, geolocation, and even webcams and microphones.*

There are three main types of cross-site scripting attacks:

##### 1. Reflected
A **reflected XSS attack** is an instance where a malicious script is sent to the server and activated during the server's response. A common example of this is the search bar of a website. In a reflected XSS attack, *criminals send their target a web link that appears to go to a trusted site*. When they click the link, it sends a HTTP request to the vulnerable site server. The attacker script is then returned or reflected back to the innocent user's browser. Here, the browser loads the malicious script because it trusts the server's response. With the script loaded, information like session cookies are sent back to the attacker.

##### 2. Stored
In a **stored XSS attack**, the malicious script isn't hidden in a link that needs to be sent to the server. Instead a stored XSS attack is an instance when malicious script is injected directly on the server. Here, *attackers target elements of a site that are served to the user*. This could be things like images and buttons that load when the site is visited. Infected elements activate the malicious code when a user simply visits the site. Stored XSS attacks can be damaging because the user has no way of knowing the site is infected beforehand.

##### 3. DOM-based
Finally there's **DOM-based XSS**. DOM stands for *Document Object Model*, which is basically the source code of a website. A DOM-based XSS attack is an instance when *malicious script exists in the web page a browser loads*. Unlike reflected XSS, these attacks don't need to be sent to the server to activate.
In a DOM-based attack, a malicious script can be seen in the URL. For example, they could hide malicious JavaScript in the HTML tags. The browser would process the HTML and execute the JavaScript.


### SQL injection
SQL is used by most web applications. For example, shopping websites use it a lot. The databases of an online clothing store likely contains a full inventory of all the items the company sells. Websites don't normally make users enter the SQL queries manually. Instead, they use things like menus, images, and buttons to show users information in a meaningful way. For example, when an online shopper clicks a button to add a sweater to their cart, it triggers a SQL query. The query runs in the background where no one can see it. Sometimes those back inquiries are vulnerable to injection attacks.

A **SQL injection** is an attack that executes unexpected queries on a database. Like cross-site scripting, SQL injection occurs due to a lack of sanitized input. The injections take place in the area of the website that are designed to accept user input. A common example is the login form to access a site. One of these forms might trigger a backend SQL statement like this when a user enters their credentials. Web forms are designed to copy user input into the statement exactly as they're written.
The statement then sends a request to the server, which runs the query. Websites that are vulnerable to SQL injection insert the user's input exactly as it's entered before running the code.

Unfortunately, this is a serious design flaw. It commonly happens because web developers expect people to use these inputs correctly. They don't anticipate attackers exploiting them. For example, an attacker might insert additional SQL code. This could cause the server to run a harmful query of code that it wasn't expecting. Malicious hackers can target these attack vectors to obtain sensitive information, modify tables and even gain administrative rights to the database.


## Prevent injection attacks

Previously, you learned that **Structured Query Language** (SQL) is a programming language used to create, interact with, and request information from a database. SQL is one of the most common programming languages used to interact with databases because it is widely supported by a range of database products.

As you might recall, malicious **SQL injection** is a type of attack that executes unexpected queries on a database. Threat actors perform SQL injections to modify, delete, or steal information from databases. A SQL injection is a common attack vector that is used to gain unauthorized access to web applications. Due to the language's popularity with developers, SQL injections are regularly listed in the OWASP® Top 10 because developers tend to focus on making their applications work correctly rather than protecting their products from injection.

In this reading, you'll learn about SQL queries and how they are used to request information from a database. You will also learn about the three classes of SQL injection attacks used to manipulate vulnerable queries. You will also learn ways to identify when websites are vulnerable and ways to address those gaps.

### SQL queries

Every bit of information that’s accessed online is stored in a database. A **database** is an organized collection of information or data in one place. A database can include data such as an organization's employee directory or customer payment methods. In SQL, database information is organized in tables. SQL is commonly used for retrieving, inserting, updating, or deleting information in tables using queries.

A _SQL query_ is a request for data from a database. For example, a SQL query can request data from an organization's employee directory such as employee IDs, names, and job titles. A human resources application can accept an input that queries a SQL table to filter the data and locate a specific person. SQL injections can occur anywhere within a vulnerable application that can accept a SQL query.

Queries are usually initiated in places where users can input information into an application or a website via an input field. Input fields include features that accept text input such as login forms, search bars, or comment submission boxes. A SQL injection occurs when an attacker exploits input fields that aren't programmed to filter out unwanted text. SQL injections can be used to manipulate databases, steal sensitive data, or even take control of vulnerable applications.

### SQL injection categories

There are three main categories of SQL injection: 

- In-band
    
- Out-of-band
    
- Inferential
    

In the following sections, you'll learn that each type describes how a SQL injection is initiated and how it returns the results of the attack.

### **In-band SQL injection**

In-band, or classic, SQL injection is the most common type. An in-band injection is one that uses the _same communication channel_ to launch the attack and gather the results.

For example, this might occur in the search box of a retailer's website that lets customers find products to buy. If the search box is vulnerable to injection, an attacker could enter a malicious query that would be executed in the database, causing it to return sensitive information like user passwords. The data that's returned is displayed back in the search box where the attack was initiated.

### **Out-of-band SQL injection**

An out-of-band injection is one that uses a _different communication channel_  to launch the attack and gather the results.

For example, an attacker could use a malicious query to create a connection between a vulnerable website and a database they control. This separate channel would allow them to bypass any security controls that are in place on the website's server, allowing them to steal sensitive data

**Note:** Out-of-band injection attacks are very uncommon because they'll only work when certain features are enabled on the target server.

### **Inferential SQL injection**

Inferential SQL injection occurs when an attacker is unable to directly see the results of their attack. Instead, they can interpret the results by analyzing the _behavior_ of the system.

For example, an attacker might perform a SQL injection attack on the login form of a website that causes the system to respond with an error message. Although sensitive data is not returned, the attacker can figure out the database's structure based on the error. They can then use this information to craft attacks that will give them access to sensitive data or to take control of the system.

### Injection Prevention

SQL queries are often programmed with the assumption that users will only input relevant information. For example, a login form that expects users to input their email address assumes the input will be formatted a certain way, such as _jdoe@domain.com_. Unfortunately, this isn’t always the case.

A key to preventing SQL injection attacks is to _escape_ _user inputs_—preventing someone from inserting any code that a program isn't expecting.

There are several ways to escape user inputs:

- A **prepared statement** is a coding technique that executes SQL statements before passing them onto the database. When the user's input is unknown, the best practice is to use these prepared statements. With just a few extra lines of code, *a prepared statement executes the code before passing it on to the server*. This means the code can be validated before performing the query.
    
- The best way to defend against SQL injection is code that will *sanitize the input*. **Input sanitization** is programming that removes user input which could be interpreted as code. Developers can write code to search for specific SQL characters. This gives the server a clearer idea of what inputs to expect. One way this is done is with prepared statements. 
    
- **Input validation**: programming that ensures user input meets a system's expectations.*Having well written code* is one of the keys to preventing SQL injection. Security teams work with program developers to test applications for these sort of vulnerabilities. Like a lot of security tasks, it's a team effort. Injection attacks are just one of many types of web-based exploits that security teams deal with.
    
- [OWASP's SQL injection detection techniques](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/05-Testing_for_SQL_Injection)